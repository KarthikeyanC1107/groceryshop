<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chandrasekar Store - Order</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f3f3f3;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .container {
            background: white;
            padding: 25px 30px;
            border-radius: 12px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 500px;
        }

        h1 {
            text-align: center;
            color: #2d3436;
        }

        label {
            font-weight: bold;
        }

        input[type="text"] {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 6px;
        }

        input[type="checkbox"],
        input[type="radio"] {
            margin-right: 6px;
        }

        button {
            background-color: #27ae60;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }

        button:hover {
            background-color: #219150;
        }

        #payNowSection {
            margin: 15px 0;
            text-align: center;
        }

        #payNowSection button {
            background-color: #2980b9;
        }

        #payNowSection button:hover {
            background-color: #2471a3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Welcome to Chandrasekar Store üè™</h1>
        <p style="text-align:center;">Order now and avoid the queue!</p>

        <form id="orderForm" method="POST">
            {% csrf_token %}
            <label>Name:</label>
            <input type="text" id="name" required>

            <label>Phone Number:</label>
            <input type="text" id="phone" required>

            <label>Select Items:</label><br>
            <input type="checkbox" value="Eggs"> Eggs<br>
            <input type="checkbox" value="Cool Drinks"> Cool Drinks<br>
            <input type="checkbox" value="Chocolates"> Chocolates<br>
            <input type="checkbox" value="Biscuits"> Biscuits<br>
            <input type="checkbox" value="Cigars"> Cigars<br><br>

            <label>Payment Method:</label><br>
            <input type="radio" name="payment" value="Pay at Shop" checked> Pay at Shop<br>
            <input type="radio" name="payment" value="Pay Online (PhonePe)"> Pay Online (PhonePe)<br><br>

            <div id="payNowSection" style="display: none;">
                <a href="upi://pay?pa=8807412430@ybl&pn=Chandrasekar%20Store" target="_blank">
                    <button type="button">üëâ Click here to Pay Online</button>
                </a>
            </div>

            <button type="submit">Place Order on WhatsApp</button>
        </form>
    </div>

    <script>
        // Show/hide "Pay Now" button based on payment method
        const paymentRadios = document.querySelectorAll("input[name='payment']");
        const payNowSection = document.getElementById("payNowSection");

        paymentRadios.forEach(radio => {
            radio.addEventListener("change", function () {
                payNowSection.style.display = (this.value === "Pay Online (PhonePe)") ? "block" : "none";
            });
        });

        document.getElementById("orderForm").addEventListener("submit", function(event) {
            event.preventDefault();

            const name = document.getElementById("name").value;
            const phone = document.getElementById("phone").value;

            const items = [];
            document.querySelectorAll("input[type=checkbox]:checked").forEach((item) => {
                items.push(item.value);
            });

            if (items.length === 0) {
                alert("Please select at least one item.");
                return;
            }

            const paymentMethod = document.querySelector("input[name='payment']:checked").value;

            // üïí Estimated pickup time
            const now = new Date();
            now.setMinutes(now.getMinutes() + 15);
            const estTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;

            let extraLine = "";
            if (paymentMethod === "Pay Online (PhonePe)") {
                extraLine = "%0APhonePe UPI ID: 8807412430@ybl%0APay here: upi://pay?pa=8807412430@ybl&pn=Chandrasekar%20Store";
            }

            const message = `üõí *New Order from Chandrasekar Store* üõí%0A
Name: ${name}%0A
Phone: ${phone}%0A
Items: ${items.join(", ")}%0A
Payment: ${paymentMethod}%0A
üïí Estimated Pickup: ${estTime}${extraLine}`;

            const whatsappLink = `https://wa.me/918807412430?text=${message}`;
            window.open(whatsappLink, '_blank');
        });
    </script>
</body>
</html>
